<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Watch Movie</title>
</head>
<body>
    <div id="player-container">
        <!-- The player iframe will be injected here -->
    </div>
    
    <div id="player-buttons">
        <button onclick="loadPlayer('videocdn')">VideoCDN</button>
        <button onclick="loadPlayer('alloha')">Alloha</button>
        <button onclick="loadPlayer('kodik')">Kodik</button>
    </div>
    
    <script>
// Extract the movie ID and type from the URL
const urlParams = new URLSearchParams(window.location.search);
const kp_id = urlParams.get('kp_id');
const imdb_id = urlParams.get('imdb_id');
const tmdb_id = urlParams.get('tmdb_id');
const title = urlParams.get('title');

// Function to fetch and display the player
function loadPlayer(source) {
    let apiUrl = `https://kinobox.tv/api/players?sources=${source}`;

    if (kp_id) {
        apiUrl += `&kinopoisk=${kp_id}`;
    } else if (imdb_id) {
        apiUrl += `&imdb=${imdb_id}`;
    } else if (tmdb_id) {
        apiUrl += `&tmdb=${tmdb_id}`;
    } else if (title) {
        apiUrl += `&title=${title}`;
    }

    // Fetch the player data
    fetch(apiUrl)
        .then(response => response.json())
        .then(data => {
            // Check if data is returned and contains an iframe
            if (data && data[0] && data[0].iframe) {
                const iframeHtml = data[0].iframe;
                document.getElementById('player-container').innerHTML = iframeHtml;
            } else {
                document.getElementById('player-container').innerHTML = '<p>No player available for this source.</p>';
            }
        })
        .catch(error => {
            console.error('Error fetching the player:', error);
            document.getElementById('player-container').innerHTML = '<p>Error loading the player.</p>';
        });
}

// Load the default player (e.g., VideoCDN) on page load
loadPlayer('videocdn');

    </script>
</body>
</html>
