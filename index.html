<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Player</title>
</head>
<body>
    <div id="player-container">
        <!-- The player iframe will be loaded here -->
    </div>
    <div id="buttons">
        <button id="videocdn" onclick="loadPlayer('videocdn')">Videocdn</button>
        <button id="alloha" onclick="loadPlayer('alloha')">Alloha</button>
        <button id="kodik" onclick="loadPlayer('kodik')">Kodik</button>
    </div>

    <script>
// Function to get query parameter by name
function getQueryParam(param) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(param);
}

// Function to load the player
function loadPlayer(source) {
    const playerContainer = document.getElementById('player-container');
    const kinopoisk = getQueryParam('kp_id');
    const imdb = getQueryParam('imdb');
    const tmdb = getQueryParam('tmdb');
    const title = getQueryParam('title');

    let apiUrl = 'https://kinobox.tv/api/players?';

    if (kinopoisk) {
        apiUrl += `kinopoisk=${kinopoisk}`;
    } else if (imdb) {
        apiUrl += `imdb=${imdb}`;
    } else if (tmdb) {
        apiUrl += `tmdb=${tmdb}`;
    } else if (title) {
        apiUrl += `title=${title}`;
    }

    apiUrl += `&sources=${source}`;

    // Fetch the player URL from the API
    fetch(apiUrl)
        .then(response => response.json())
        .then(data => {
            // Assuming the API returns a URL to the player
            const playerUrl = data.player_url; // Update with actual field from API response

            // Create or update the iframe
            let iframe = document.getElementById('player-iframe');
            if (!iframe) {
                iframe = document.createElement('iframe');
                iframe.id = 'player-iframe';
                iframe.width = '100%';
                iframe.height = '500px'; // Adjust height as needed
                iframe.allowFullscreen = true;
                playerContainer.appendChild(iframe);
            }
            iframe.src = playerUrl;
        })
        .catch(error => {
            console.error('Error fetching player:', error);
            playerContainer.innerHTML = '<p>Error loading player. Please try again later.</p>';
        });
}

// Load the default player (e.g., videocdn) on page load
window.onload = () => {
    loadPlayer('videocdn');
};

        
    </script>
</body>
</html>
